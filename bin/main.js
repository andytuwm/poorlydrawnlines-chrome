window.onload=function(){"use strict";setTimeout(function(){function a(){w=this.response.title.replace(/Poorly Drawn Lines(\s\W\s)/i,"");var a=s-r;document.getElementById("comicTitle").innerHTML=w,document.getElementById("comicNumber").innerHTML="#"+a,document.getElementById("comic").src=this.response.querySelector("#post img").src,document.getElementById("comic").title=w,k(z)}function b(){t=this.response.querySelector("#content > ul").children,r=0,s=t.length-1,u=t[0].firstChild.href,v=t[s].firstChild.href,c(u),document.getElementById("end").dismiss}function c(b){x=b;var c=new XMLHttpRequest;c.responseType="document",c.onload=a,c.open("GET",b,!0),c.send()}function d(){r!==s?(r=s,c(v)):document.getElementById("end").show()}function e(){s>=r+1?(r+=1,c(o(r))):document.getElementById("end").show()}function f(){r=Math.floor(Math.random()*s),c(o(r))}function g(){r-1>=0?(r-=1,c(o(r))):document.getElementById("end").show()}function h(){0!==r?(r=0,c(u)):document.getElementById("end").show()}function i(){if(13===window.event.keyCode){var a=document.getElementById("input").committedValue;a.match(/[a-z]/i)||!a.match(/[0-9]+/)?document.getElementById("badinput").show():s-a===r?document.getElementById("already").show():a>=0&&s>=a?(r=s-a,c(o(r))):document.getElementById("badnum").show(),document.getElementById("input").value=""}}function j(){chrome.tabs.create({url:x,active:!1})}function k(a){var b=w,c={com:r,disp:b};if(m(a,r)){var d=n(a,r);if(d>-1){var e=a.splice(d,1);a.push(e[0])}else console.error("Error: Index should always be found if comic was found in history.")}else a.length<10?a.push(c):(a.shift(),a.push(c)),y.historyList=a;chrome.storage.sync.set({browsed:a},function(){})}function l(){var a=H.selectedIndex;r=z[a].com,c(o(r)),H.selected=null}function m(a,b){if(a)for(var c=0;c<a.length;c++)if(a[c].com==b)return!0;return!1}function n(a,b){if(a)for(var c=0;c<a.length;c++)if(a[c].com==b)return c;return-1}function o(a){return t[a].firstChild.href}function p(){document.getElementById("404").show()}var q=new XMLHttpRequest,r=null,s=null,t=null,u=null,v=null,w=null,x=null,y=document.getElementById("array"),z=[];chrome.storage.sync.get("browsed",function(a){a.browsed&&(z=a.browsed,y.historyList=z)}),q.responseType="document",q.onload=b,q.open("GET","http://poorlydrawnlines.com/archive/",!0),q.send();var A=document.getElementById("first"),B=document.getElementById("prev"),C=document.getElementById("random"),D=document.getElementById("next"),E=document.getElementById("last"),F=document.getElementById("comic"),G=document.getElementById("search"),H=(document.getElementById("explain"),document.getElementById("historyMenu")),I=document.getElementById("comic");A.onload=A.addEventListener("click",d,!1),B.onload=B.addEventListener("click",e,!1),C.onload=C.addEventListener("click",f,!1),D.onload=D.addEventListener("click",g,!1),E.onload=E.addEventListener("click",h,!1),F.onload=F.addEventListener("click",j,!1),G.onload=G.addEventListener("keyup",i,!1),H.onload=H.addEventListener("core-activate",l,!1),I.onerror=p},100)};