window.onload=function(){"use strict";setTimeout(function(){function a(){x=this.response.title.replace(/Poorly Drawn Lines(\s\W\s)/i,"");var a=t-s;document.getElementById("comicTitle").innerHTML=x,document.getElementById("comicNumber").innerHTML="#"+a,document.getElementById("comic").src=this.response.querySelector("#post img").src,document.getElementById("comic").title=x,k(B)}function b(){u=this.response.querySelector("#content > ul").children,s=0,t=u.length-1,v=u[0].firstChild.href,w=u[t].firstChild.href,c(v),document.getElementById("end").dismiss,K.style.WebkitAnimation="fadeIn 0.5s ease-in 1 forwards"}function c(b){y=b;var c=new XMLHttpRequest;c.responseType="document",c.onload=a,c.open("GET",b,!0),c.send()}function d(){s!==t?(s=t,c(w)):document.getElementById("end").show()}function e(){t>=s+1?(s+=1,c(o(s))):document.getElementById("end").show()}function f(){E.style.WebkitAnimation="fullSpin 0.8s ease-in-out",s=Math.floor(Math.random()*t),c(o(s))}function g(){s-1>=0?(s-=1,c(o(s))):document.getElementById("end").show()}function h(){0!==s?(s=0,c(v)):document.getElementById("end").show()}function i(){if(13===window.event.keyCode){var a=document.getElementById("input").committedValue;a.match(/[a-z]/i)||!a.match(/[0-9]+/)?document.getElementById("badinput").show():t-a===s?document.getElementById("already").show():a>=0&&t>=a?(s=t-a,c(o(s))):document.getElementById("badnum").show(),document.getElementById("input").value=""}}function j(){chrome.tabs.create({url:y,active:!1})}function k(a){var b=x,c={com:s,disp:b};if(m(a,s)){var d=n(a,s);if(d>-1){var e=a.splice(d,1);a.push(e[0])}else console.error("Error: Index should always be found if comic was found in history.")}else a.length<10?a.push(c):(a.shift(),a.push(c)),A.historyList=a;chrome.storage.sync.set({browsed:a},function(){})}function l(){var a=J.selectedIndex;s=B[a].com,c(o(s)),J.selected=null}function m(a,b){if(a)for(var c=0;c<a.length;c++)if(a[c].com==b)return!0;return!1}function n(a,b){if(a)for(var c=0;c<a.length;c++)if(a[c].com==b)return c;return-1}function o(a){return u[a].firstChild.href}function p(){document.getElementById("404").show()}function q(){z?(document.getElementById("image").style.overflowY="hidden",H.style.maxHeight="475px",K.style.WebkitAnimation="spinBack 0.3s ease-in-out 1 forwards",z=!1):(document.getElementById("image").style.overflowY="scroll",H.style.maxHeight="none",K.style.WebkitAnimation="spin 0.3s ease-in-out 1 forwards",z=!0)}var r=new XMLHttpRequest,s=null,t=null,u=null,v=null,w=null,x=null,y=null,z=!1,A=document.getElementById("array"),B=[];chrome.storage.sync.get("browsed",function(a){a.browsed&&(B=a.browsed,A.historyList=B)}),r.responseType="document",r.onload=b,r.open("GET","http://poorlydrawnlines.com/archive/",!0),r.send();var C=document.getElementById("first"),D=document.getElementById("prev"),E=document.getElementById("random"),F=document.getElementById("next"),G=document.getElementById("last"),H=document.getElementById("comic"),I=document.getElementById("search"),J=(document.getElementById("explain"),document.getElementById("historyMenu")),K=document.getElementById("expand");C.onload=C.addEventListener("click",d,!1),D.onload=D.addEventListener("click",e,!1),E.onload=E.addEventListener("click",f,!1),F.onload=F.addEventListener("click",g,!1),G.onload=G.addEventListener("click",h,!1),H.onload=H.addEventListener("click",j,!1),I.onload=I.addEventListener("keyup",i,!1),J.onload=J.addEventListener("core-activate",l,!1),K.onload=K.addEventListener("click",q,!1),H.onerror=p},100)};